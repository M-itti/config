#!/bin/bash

# Find BOOTCAMP partition
bootcamp_disk=$(diskutil list | grep "Microsoft Basic Data" | awk '{print $NF}')

if [ -z "$bootcamp_disk" ]; then
  echo "âŒ Could not find Boot Camp partition."
  exit 1
fi

echo "âœ… Found Boot Camp partition at /dev/$bootcamp_disk"

# Mount it
echo "ğŸ”§ Mounting..."
sudo diskutil mount /dev/$bootcamp_disk

# Get the mount path
mount_path=$(mount | grep "/dev/$bootcamp_disk" | awk '{print $3}')

if [ -z "$mount_path" ]; then
  echo "âŒ Failed to mount Boot Camp partition."
  exit 1
fi

echo "ğŸ“‚ Mounted at $mount_path"

# Set next boot to Boot Camp
echo "ğŸ§­ Blessing Windows volume for next boot..."
sudo bless --mount "$mount_path" --setBoot --nextonly

# Reboot
echo "ğŸ” Rebooting into Windows..."
sudo reboot
